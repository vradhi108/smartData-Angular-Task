<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid nav-display">
            <h2>Welcome To Our Page</h2>
        </div>
    </nav>
    <div class="container myform">
        <div class="col-md-6">
            
            <form [formGroup]="form" (ngSubmit)="onClick()" class="form" appBlockCopyPaste>
                
                <div class="container boundary">
                    <div class="mb-3">
                        <label for="firstname" class="form-label">First Name</label> 
                        <input type="text" name="firstname" class="form-control" formControlName="firstname" BlockCopyPasteDirective>
                        <div *ngIf="form.get('firstname')?.invalid && form.get('firstname')?.touched" class="error">
                            This field is required
                        </div>
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="lastname" class="form-label">Last Name</label> 
                        <input type="text" name="lastname" class="form-control" formControlName="lastname" BlockCopyPasteDirective>
                        <div *ngIf="form.get('lastname')?.invalid && form.get('lastname')?.touched" class="error">
                            This field is required
                        </div>
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label> 
                        <input type="email" name="email" class="form-control" formControlName="email">
                        <div *ngIf="form.get('email')?.invalid && form.get('email')?.touched" class="error">
                            This field is required or the input is invalid
                        </div>

                        
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="phonenumber" class="form-label">Phone number</label> 
                        <input type="text" name="phonenumber" pattern="[0-9]*" class="form-control" formControlName="phonenumber">
                        <div *ngIf="form.get('phonenumber')?.invalid && form.get('phonenumber')?.touched" class="error">
                            This field is required or the input is invalid
                        </div>
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="age" class="form-label">Age</label> 
                        <input type="number" name="age" class="form-control" formControlName="age" min="1">
                        <div *ngIf="form.get('age')?.invalid && form.get('age')?.touched" class="error">
                            This field is required
                        </div>
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="gender" class="form-label">Gender</label> 
                        <br>
                        <select class="form-control" formControlName="gender">
                            <option value="">Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                        <div *ngIf="form.get('gender')?.invalid && form.get('gender')?.touched" class="error">
                            This field is required
                        </div>
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="country" class="form-label">Country</label> 
                        <br>
                        
                        <select class="form-control" [(ngModel)]="selectedCountry" (change)="onCountryChange()" formControlName="country">
                            <option value="">Select country</option>
                            <option *ngFor="let country of countries" [value]="country.name">{{country.name}}</option>
                        </select>
                        <div *ngIf="form.get('country')?.invalid && form.get('country')?.touched" class="error">
                            This field is required
                        </div>
                    </div>
                    <br>
                    
                    <div class="mb-3">
                        <label for="state" class="form-label">State</label> 
                        <br>
                        <select class="form-control" [(ngModel)]="selectedState" (change)="onCountryChange()" formControlName="state">
                            <option value="">Select State</option>
                            <option *ngFor="let state of filteredStates" [value]="state">{{state}}</option>
                        </select>
                        <div *ngIf="form.get('state')?.invalid && form.get('state')?.touched" class="error">
                            This field is required
                        </div>
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="address" class="form-label">Address</label> 
                        <input type="text" name="address" class="form-control" formControlName="address">
                        <div *ngIf="form.get('address')?.invalid && form.get('address')?.touched" class="error">
                            This field is required
                        </div>
                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="password" class="form-label" >Password</label>
                        <input type="password" name="password" class="form-control" (mouseenter)="showPasswordRules = true" (mouseleave)="showPasswordRules = false" formControlName="password" #pw>
                        <div *ngIf="form.get('password')?.invalid && form.get('password')?.touched" class="error">
                            This field is required
                        </div>
                        <div class="password-rules" *ngIf="showPasswordRules">
                            Password must be at least 8 characters long, contain at least one uppercase letter, one lowercase letter, one number, and one special character.
                          </div>

                    </div>
                    <br>
                    <div class="mb-3">
                        <label for="confirmPassword" class="form-label">Confirm Password</label>
                        <input  (mouseenter)="touch = true" type="password" name="confirmPassword" class="form-control" formControlName="confirmPassword" #cpw (keyup)="checkPassword(pw.value, cpw.value)">
                        <div *ngIf="form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched" class="error">
                            This field is required
                        </div>
                        <div *ngIf="!isPasswordCorrect && isPasswordFilled" class="error">Password didn't match</div>
                       
                    </div>
                    <div>
                        <p>Already have an account? <a [routerLink]="['/login']">LogIn</a> </p>
                    </div>
                    <div *ngIf="invalid" >
                        <h3 class="error">
                            Enter Valid Details
                        </h3>
                    </div>
                    <div class="button-center">
                        <button  class="btni btn btn-success" type="submit">Create Account</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</body>
</html>